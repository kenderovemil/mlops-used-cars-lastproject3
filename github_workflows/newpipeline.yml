name: full_pipeline
description: End-to-end ML workflow integrating data prep, training, tuning, and registration
type: pipeline
inputs:
  raw_data:
    type: uri_file
    path: azureml:skycore_input_data_awakening:2
    mode: download

jobs:
  prep_data:
    type: command
    component: azureml:prep_data_component:1
    inputs:
      raw_data: ${{inputs.raw_data}}
    outputs:
      clean_data: ${{outputs.clean_data}}
    compute: cpu-cluster

  train_model:
    type: command
    component: azureml:train_model_component:1
    inputs:
      clean_data: ${{jobs.prep_data.outputs.clean_data}}
    outputs:
      model_output: ${{outputs.model_output}}
    compute: cpu-cluster

  tune_model:
    type: command
    component: azureml:tune_model_component:1
    inputs:
      model_output: ${{jobs.train_model.outputs.model_output}}
    outputs:
      best_model: ${{outputs.best_model}}
    compute: cpu-cluster

  register_model:
    type: command
    component: azureml:register_model_component:1
    inputs:
      best_model: ${{jobs.tune_model.outputs.best_model}}
    compute: cpu-cluster
